   10 REM WOZMON - PORTED BY PNGWEN
   20 PRINT:INPUT IN$:IN$=IN$+CHR$(13)
   30 Y=0
   40 A=0
   50 X=0
   60 MO=A
   70 Y=Y+1
   80 A=ASC(MID$(IN$,Y,1))
   90 IF A=13 THEN GOTO 20
   91 IF A<46 THEN GOTO 70
   95 IF A=81 THEN END
  100 IF A=46 OR A=61 THEN GOTO 60
  110 IF A=82 THEN GOTO 320
  120 H=0
  130 YS=Y
  140 A=ASC(MID$(IN$,Y,1))
  150 A=(A AND -49) OR (NOT(A) AND 48)
  160 IF A<10 THEN GOTO 200
  170 A=A+137
  180 C=(A+6) AND 256:A=A AND 255
  190 IF C=0 THEN GOTO 280
  200 A=A*16 AND 255
  210 FOR I=1 TO 4
  220 A=A*2
  230 C=(A AND 256)/256:A=A AND 255
  240 H=(H*2+C):IF H>32767 THEN H=H-65536
  245 H=H AND -1
  250 NEXT I
  260 Y=Y+1
  270 GOTO 140
  280 IF Y=YS THEN GOTO 20
  290 IF MO<>61 THEN GOTO 330
  300 POKE SD,H:SD=SD+1
  310 GOTO 80
  320 RA=XA:IF RA<0 THEN RA=RA+65536
  321 PRINT:SYS RA:GOTO 20
  330 IF MO=46 THEN GOTO 420
  340 SD=H:XA=H:A=0:IF SD<0 THEN SD=SD+65536
  350 IF A<>0 THEN GOTO 400
  360 PRINT
  370 A=XA/256:GOSUB 1000
  380 A=XA:GOSUB 1000
  390 PRINT ":";
  400 PRINT " ";
  405 X2=XA:IF X2<0 THEN X2=X2+65536
  410 A=PEEK(X2):GOSUB 1000
  420 IF XA>=H THEN MO=0:GOTO 80
  430 XA=XA+1
  440 A=XA AND 7
  450 GOTO 350
 1000 REM PRBYTE
 1010 SA=A
 1020 A=A/16
 1030 GOSUB 1200
 1040 A=SA
 1200 REM PRHEX
 1210 A=A AND 15
 1220 IF A>9 THEN A=A+7
 1230 A=A+48
 1240 PRINT CHR$(A);
 1250 RETURN
